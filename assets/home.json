{
    "$view": {
        "actions": [
            {
                "_type": "Function",
                "attributes": {
                    "_target": "mainBeacon",
                    "functionName": "start"
                },
                "on": "didLoad,willFirstAppear"
            },
            {
                "_type": "zAlert",
                "attributes": {
                    "message": "Did load"
                },
                "on": "didLoad"
            }
        ],
        "attributes": {
            "_id": "garage",
            "bg.color": "#cdcdcd",
            "statusBar.style": "dark"
        },
        "controls": [
            {
                "_id": "mainBeacon",
                "_type": "Beacon",
                "actions": [
                    {
                        "_type": "Alert",
                        "attributes": {
                            "title": "Entered region"
                        },
                        "on": "enteredBeaconRegion"
                    },
                    {
                        "_type": "Alert",
                        "attributes": {
                            "title": "Exited region"
                        },
                        "on": "exitedBeaconRegion"
                    },
                    {
                        "_type": "Notify",
                        "attributes": {
                            "message": "You are near a beacon",
                            "title": "Beacon around"
                        },
                        "on": "enteredBeaconRegion"
                    },
                    {
                        "_type": "Notify",
                        "attributes": {
                            "message": "You are leaving a beacon region!",
                            "title": "Beacon away"
                        },
                        "on": "exitedBeaconRegion"
                    }
                ],
                "attributes": {
                    "distanceFilter": "notsurewhatgoeshere",
                    "regionUUIDs": "f7826da6-4fa2-4e98-8024-bc5b71e0893e,B9407F30-F5F8-466E-AFF9-25556B57FE6D,ED3A6985-8872-4BB7-B784-C59EF3589844"
                }
            },
            {
                "_id": "layoutMain",
                "_type": "Layout",
                "attributes": {
                    "bg.color": "ffffff",
                    "layoutType": "float",
                    "size.h": "100%",
                    "size.w": "100%",
                    "visible": true
                },
                "controls": [
                    {
                        "_id": "customHeader",
                        "_type": "Custom",
                        "actions": [
                            {
                                "_type": "Function",
                                "attributes": {
                                    "_target": "$app",
                                    "functionName": "drawer.l.toggle"
                                },
                                "on": "button.left"
                            }
                        ],
                        "attributes": {
                            "button.left": "../images/btnMenu_42x42.png",
                            "controlLocation": "/controls/header.json",
                            "layoutType": "float",
                            "size.h": 62,
                            "size.w": "100%",
                            "title": "Home",
                            "visible": true
                        },
                        "controls": []
                    },
                    {
                        "_id": "layoutProfilePhoto",
                        "_type": "Layout",
                        "attributes": {
                            "layoutType": "float",
                            "margin.top": 62,
                            "size.h": 290,
                            "size.w": "100%"
                        },
                        "controls": [
                            {
                                "_id": "fbProfileBlur",
                                "_type": "FBProfile",
                                "attributes": {
                                    "align.h": "center",
                                    "align.v": "top",
                                    "blur.enabled": true,
                                    "layoutType": "float",
                                    "size.h": "100%",
                                    "size.w": "100%"
                                }
                            },
                            {
                                "_id": "fbProfilePic",
                                "_type": "FBProfile",
                                "attributes": {
                                    "align.h": "center",
                                    "align.v": "top",
                                    "border.color": "ffffff",
                                    "border.radius": "{{[[$self.size.w]] / 2}}",
                                    "border.size": 2,
                                    "layoutType": "float",
                                    "margin.top": 30,
                                    "size.h": 120,
                                    "size.w": 120
                                }
                            },
                            {
                                "_id": "fbProfileName",
                                "_type": "Text",
                                "attributes": {
                                    "align.h": "center",
                                    "align.v": "top",
                                    "color": "ffffff",
                                    "font": "Aileron-Light:22",
                                    "layoutType": "float",
                                    "margin.top": 170,
                                    "text": "[[fbProfilePic.name]]"
                                }
                            },
                            {
                                "_id": "layoutSummaryBackground",
                                "_type": "Layout",
                                "attributes": {
                                    "align.v": "bottom",
                                    "bg.color": "00000010",
                                    "layoutType": "float",
                                    "size.h": 60,
                                    "size.w": "100%"
                                },
                                "controls": [
                                    {
                                        "_id": "layoutSummaryBorder",
                                        "_type": "Layout",
                                        "attributes": {
                                            "bg.color": "00000010",
                                            "layoutType": "float",
                                            "size.h": 1,
                                            "size.w": "100%"
                                        },
                                        "controls": []
                                    },
                                    {
                                        "_id": "textLatestSavings",
                                        "_type": "AttributedText",
                                        "attributes": {
                                            "align.h": "center",
                                            "align.v": "middle",
                                            "font": "Aileron-Light:18",
                                            "layoutType": "float",
                                            "markdown.enabled": true,
                                            "padding.bottom": 8
                                        }
                                    }
                                ]
                            }
                        ]
                    }
                ]
            }
        ],
        "datasources": [
            {
                "_id": "dataBaasProfile",
                "_type": "HTTP",
                "actions": [
                    {
                        "_type": "Modify",
                        "attributes": {
                            "_target": "textLatestSavings"
                        },
                        "on": "success",
                        "set": {
                            "text": "{#333333|Your last ride:} {#ffffff|[[$self.response.body.distance.latest]] [[$self.response.body.distance.unit]] / [[$self.response.body.savings.latest]] [[$self.response.body.savings.unit]] COâ‚‚ saved}"
                        }
                    },
                    {
                        "_type": "Refresh",
                        "attributes": {
                            "_target": "textLatestSavings"
                        },
                        "on": "success"
                    }
                ],
                "attributes": {
                    "autoLoad.enabled": true,
                    "headers": {
                        "access_token": "[[$session.access_token]]"
                    },
                    "method": "GET",
                    "requestType": "json",
                    "responseType": "json",
                    "url": "https://vta-prod.apigee.net/karma/v1/me/profile"
                }
            },
            {
                "_id": "dataFacebookProfile",
                "_type": "HTTP",
                "actions": [],
                "attributes": {
                    "autoLoad.enabled": true,
                    "method": "GET",
                    "queryParams": {
                        "access_token": "[[$session.fb_token]]",
                        "fields": "hometown"
                    },
                    "requestType": "json",
                    "responseType": "json",
                    "url": "https://graph.facebook.com/v2.5/me"
                }
            }
        ]
    }
}